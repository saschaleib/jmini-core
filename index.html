<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>jMini Core Index</title>
		<script src="page/page_core.min.js"></script>
		<script src="data/JSON.load.min.js"></script>
		<script src="elements/HTMLElement.new.min.js"></script>
		<script src="elements/Element.appendNew.min.js"></script>
		<script src="elements/Element.setHtml.min.js"></script>
		<script>
		
			/* everything related to the data model */
			$p.data = {
			
				_baseURL: 'https://jmini.nuropa.eu/dev/',
				_docsURL: 'https://jmini.nuropa.eu/wiki/',
						
				_init: function() {
					//console.info('$p.data._init()');
										
					$p.data.loadIndex();
					
				},
				
				loadIndex: function() {
					//console.info('$p.data.loadIndex()');

					let main = document.getElementsByTagName('main')[0];

					JSON.load($p.data._baseURL + 'index.json')
					.then( result => {

						result.topics.forEach( it => {
						
							// add a new details section
							it._det = main.appendNew('details', {
								'class': 'topic',
								'data-id': it.topic,
								'title': it.desc,
								'open': ''
							}, HTMLElement.new('summary', {}, it.title));

							// load the sub-items:
							$p.data.loadTopic(it);
						
						});
					})
					.catch( error => {
						console.error(error.toString());
					})
				},
				loadTopic: function(topic) {
					//console.info('$p.data.loadTopic(',topic,')');

					JSON.load($p.data._baseURL + topic.path + 'index.json')
					.then( result => {
						
						// create a list to add the items to:
						const ul = topic._det.appendNew('ul');
						
						// add all the items:
						result.forEach( mod => {
							const li = ul.appendNew('li', {
								'class': 'moduls',
								'data-id': mod.id,
								'open': ''
							});
							
							const path = $p.data._baseURL + topic.path + mod.file;
							
							li.appendNew('strong').setHtml(mod.namehtml || mod.name); // title
							li.appendNew('a', {
								'href': path + '.js',
							}, "Source");
							li.appendNew('a', {
								'href': path + '.min.js',
							}, "Min");
							li.appendNew('a', {
								'href': path + '.test.html',
							}, "Test");
							li.appendNew('a', {
								'href': $p.data._docsURL + mod.moreinfo,
							}, "Docs");
							li.appendNew('br');
							li.appendNew('i', {}, mod.desc);
						});
					})
					.catch( error => {
						console.error(error.toString());
					})



				}
			}
		</script>
		<style>
			main {
				& > details {
				}
				summary {
					font-size: 1.5em;
					cursor: pointer;
					margin-bottom: 1em;
				}
				ul {
					& {
						list-style: none inside;
						padding: 0;
						margin: .25em 0 1em 1.5em;
					}
					li {
						& {
							margin: 0 0 .5em 0;
							padding: .25em;
							display: grid;
							grid-template-columns: auto 3.5em 2.2em 2.2em 2.5em;
						}
						&:nth-of-type(odd) {
							background: #e0e0e0;
						}
						i {
							grid-row: 2;
							grid-column: 1 / span 5;
						}
					}
				}
			}
		</style>

	</head>
	<body>
		<header>
			<h1>jMini Core</h1>
			<p>
				This page shows an automatically generated overview of the available functions:
			</p>
		</header>
		<main>
		</main>
		<footer>
		</footer>
	</body>
</html>